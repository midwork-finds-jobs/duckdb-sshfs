# name: test/sql/secrets/create_secret_sshfs.test
# description: Test SSHFS secret creation
# group: [secrets]

# Require sshfs extension
require sshfs

# Test 1: Create SSH secret with password
statement ok
CREATE SECRET sshfs_test (
    TYPE SSH,
    username 'test_user',
    password 'test_password',
    SCOPE 'sshfs://example.com'
);

# Verify the secret exists
query I
SELECT count(*) FROM duckdb_secrets() WHERE name = 'sshfs_test';
----
1

# Verify secret type
query I
SELECT type FROM duckdb_secrets() WHERE name = 'sshfs_test';
----
ssh

# Test 2: Create SSH secret with key_path
statement ok
CREATE SECRET sshfs_key_test (
    TYPE SSH,
    username 'u123456',
    key_path '/path/to/key',
    port 23,
    SCOPE 'sshfs://u123456.your-storagebox.de'
);

# Verify key-based secret exists
query I
SELECT count(*) FROM duckdb_secrets() WHERE name = 'sshfs_key_test';
----
1

# Test 3: Create SSH secret with custom port
statement ok
CREATE SECRET sshfs_port_test (
    TYPE SSH,
    username 'testuser',
    password 'testpass',
    port 2222,
    SCOPE 'sshfs://localhost:2222'
);

# Verify port secret exists
query I
SELECT count(*) FROM duckdb_secrets() WHERE name = 'sshfs_port_test';
----
1

# Cleanup
statement ok
DROP SECRET sshfs_test;

statement ok
DROP SECRET sshfs_key_test;

statement ok
DROP SECRET sshfs_port_test;
